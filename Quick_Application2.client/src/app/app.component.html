@if (isUserLoggedIn) {

<!-- Top navigation (global) -->
<header class="topbar" role="banner" aria-label="Application top bar">
  <div class="topbar-inner">
    <!-- Left: Brand -->
    <div class="brand">
      <div class="logo-circle">
        <span class="logo-text">JMS</span>
      </div>
      <div class="app-title">Jail Management System</div>
    </div>

    <!-- Center: Global search -->
    <div class="topbar-center">
      <input type="search"
             class="global-search"
             placeholder="Search inmates, staff, or records..."
             aria-label="Search" />
    </div>

    <!-- Right: Actions -->
    <div class="topbar-actions">
      <!-- Notifications -->
      <button class="icon-btn notifications"
              aria-label="Notifications"
              title="Notifications">
        <span class="badge" *ngIf="newNotificationCount > 0">{{ newNotificationCount }}</span>
        <span class="material-symbols-outlined" aria-hidden="true">notifications</span>
      </button>

      <!-- User chip -->
      <<div class="user-info" title="User">
        <div class="user-avatar" aria-hidden="true">
          {{ (fullName || userName || 'Officer').substring(0, 2).toUpperCase() }}
        </div>
        <div class="user-name">{{ fullName || userName || 'Officer' }}</div>

        <button class="dropdown-arrow" aria-label="User menu">
          <span class="material-symbols-outlined">expand_more</span>
        </button>

        <!-- NEW: Logout button inside user-info -->
        <button class="icon-btn logout-btn"
                type="button"
                title="Logout"
                aria-label="Logout"
                (click)="logout()">
          <span class="material-symbols-outlined" aria-hidden="true">logout</span>
        </button>
      </div>

    </div>
  </div>
</header>

<!-- Left navigation (icon rail) -->
<aside class="left-rail" role="navigation" aria-label="Primary navigation">
  <!-- Hamburger -->
  <button class="icon-btn hamburger" type="button" aria-label="Menu">
    <span class="material-symbols-outlined">menu</span>
  </button>

  <nav class="icon-nav">
    <a class="icon-btn"
       routerLink="/"
       [routerLinkActiveOptions]="{ exact: true }"
       routerLinkActive="active"
       title="Dashboard"
       aria-label="Dashboard">
      <span class="material-symbols-outlined">show_chart</span>
    </a>

    <a class="icon-btn"
       routerLink="/intake"
       routerLinkActive="active"
       title="Intake"
       aria-label="Intake">
      <span class="material-symbols-outlined">fingerprint</span>
    </a>

    <a class="icon-btn"
       routerLink="/inmates"
       routerLinkActive="active"
       title="Inmates"
       aria-label="Inmates">
      <span class="material-symbols-outlined">person_search</span>
    </a>

    <a class="icon-btn"
       routerLink="/legal"
       routerLinkActive="active"
       title="Legal"
       aria-label="Legal">
      <span class="material-symbols-outlined">gavel</span>
    </a>

    <a class="icon-btn"
       routerLink="/staff"
       routerLinkActive="active"
       title="Staff"
       aria-label="Staff">
      <span class="material-symbols-outlined">groups</span>
    </a>

    <a class="icon-btn"
       routerLink="/records"
       routerLinkActive="active"
       title="Records"
       aria-label="Records">
      <span class="material-symbols-outlined">folder_open</span>
    </a>
  </nav>
</aside>

<!-- App content -->
<main class="app-content" role="main" aria-live="polite">
  <router-outlet></router-outlet>
</main>

}

@else {
<main class="app-content guest" role="main" aria-live="polite">
  <router-outlet></router-outlet>
</main>
}
